<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:his="http://centling.his.net/histag"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">
<f:view contentType="text/html">

<style>


.reportlevel1 {
	width: 80px;
	border: 1px solid;
	text-align: center;
	font-family: simsun;
	font-size: 16px;
	font-weight:bold;
	
}

.reportlevel3 {
	width: 60px;
	border: 0px ;
	text-align: center;
	font-family: simsun;
	font-size: 16px;
	
}


.reportlevel4 {
	width: 60px;
	border: 0px ;
	text-align: center;
	font-family: simsun;
	font-size: 16px;
	font-weight:bold;
}


.reportlevel2 {
	width: 30px;
	border: 1px solid;
	text-align: center;
	font-family: simsun;
	font-size: 12px;
	
}

.reportnormaltr {
	
}

.ui-panel .ui-panel-content {
	padding: 0em !important;
}
</style>

	<h:head>
		<title>#{pageConfig.totalNurseWeekly}</title>


		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/default.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/skin.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/layout.css"></link>
		<link href="#{request.contextPath}/css/css.css" rel="stylesheet"
			type="text/css" />
		<link rel="stylesheet" href="#{request.contextPath}/css/style.css"></link>

		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/ime.js?ver=#{projectConfig.ver}" />
		<h:outputScript library="javax.faces" name="jsf.js" target="head" />
		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/common.js?ver=#{projectConfig.ver}" />
		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/calendar.js?ver=#{projectConfig.ver}" />
	</h:head>


	<h:body>
	<p:growl id="message" widgetVar="message"></p:growl>
		<p:growl id="messages"></p:growl>
		<h:form id="searchForm" style="display: inline">
		<table style="border: 0px;">
		<tr>
		<td>
		<h:outputText value="起始时间:" style="text-align:right" />
		</td>
		<td>
		<p:calendar id="startDate" pattern="yyyy-MM-dd HH:mm"  
			value="#{capitalFlowController.startDate}"  >
		</p:calendar>
		</td>
		<td>
		<h:outputText value="结束时间:" style="text-align:right" />
		</td>
		<td>
		<p:calendar id="endDate" pattern="yyyy-MM-dd HH:mm"  
			value="#{capitalFlowController.endDate}"  >
		</p:calendar>
		</td>
		<td>
		
		<p:commandButton value="查询" styleClass="commonbtn"
			ajax="true" id="searchBtn"
			action="#{capitalFlowController.search}"
			update=":pieForm,:reportForm,:messages" 
			process="@this,startDate,endDate">
		</p:commandButton>
		<p:commandButton value="导出" styleClass="commonbtn"
					onclick="exportExcelFun()"
					type="button"
					update=":messages">
		</p:commandButton>
		</td>
		</tr>
		</table>
		</h:form>
		
<table><tr><td valign="top">
		<h:form id="reportForm">
		<br></br>
		<br></br>
		<font style="font-size:20pt;font-weight:bold">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;资金流动情况一览</font>
		<br></br>
		<br></br>
		<nobr>
		<h:outputText style="display:none;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;" 
			value="开始时间:" />
		<h:outputText style="display:none;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;" 
			value="#{capitalFlowController.startDate}">
			<f:convertDateTime pattern="yyyy-MM-dd" />
		</h:outputText>
		<h:outputText style="display:none;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;" 
			value="结束时间:" />
		<h:outputText style="display:none;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;" 
			value="#{capitalFlowController.endDate}">
			<f:convertDateTime pattern="yyyy-MM-dd" />
		</h:outputText>
		</nobr>
		<br></br>
		<h:outputText style="text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;" 
			value="总收入:#{capitalFlowController.totalIn}&nbsp;&nbsp;总支出:#{capitalFlowController.totalOut}"></h:outputText>
		<table id="generalDate" 
			style="width: 100%;height: 35px;border: 2px solid;border-width:2px 2px 2px 2px;border-right:2px solid">
		<tr >
		<td style="width: 200px;border: 1px solid;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;"  
			BORDER="1" bordercolordark="#000000" bordercolorlight="#ffffff">项目</td>
		<ui:repeat value="#{capitalFlowController.buildings}" var="building">
		<td style="width: 90px;border: 1px solid;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;">
		<h:outputText value="#{building.name}"></h:outputText>
		</td>
		</ui:repeat>
		<td style="width: 90px;border: 1px solid;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;">总计</td>
		</tr>
		<tr >
		<td style="width: 80px;border: 1px solid;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;"
			align="left" colspan="#{fn:length(capitalFlowController.buildings)+2}"><h:outputText value="缴费项目"></h:outputText></td>
		</tr>
		<ui:repeat value="#{capitalFlowController.itemPurseReports}" var="capitalFlowReport">
		<tr>
		<td style="width: 80px;border: 1px solid;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;">
		<h:outputText value="#{capitalFlowReport.itemName}"></h:outputText></td>
		<ui:repeat var="buildingTotal" value="#{capitalFlowReport.buildingTotals}">
		<td style="width: 30px;border: 1px solid;text-align: center;font-family: simsun;font-size: 12px;">
			<h:outputText value="#{buildingTotal.totalfee}">
				<f:convertNumber pattern="0.00" />
			</h:outputText>
		</td>
		</ui:repeat>
		<td style="width: 30px;border: 1px solid;text-align: center;font-family: simsun;font-size: 12px;">
		<h:outputText value="#{capitalFlowReport.totalFees}">
			<f:convertNumber pattern="0.00" />
		</h:outputText></td>
		</tr>
		</ui:repeat>
		<tr >
		<td style="width: 80px;border: 1px solid;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;"
			align="left" colspan="#{fn:length(capitalFlowController.buildings)+2}"><h:outputText value="菜品项目"></h:outputText></td>
		</tr>
		<ui:repeat value="#{capitalFlowController.foodMenuReports}" var="capitalFlowReport">
		<tr>
		<td style="width: 80px;border: 1px solid;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;">
		<h:outputText value="#{capitalFlowReport.itemName}"></h:outputText></td>
		<ui:repeat var="buildingTotal" value="#{capitalFlowReport.buildingTotals}">
		<td style="width: 30px;border: 1px solid;text-align: center;font-family: simsun;font-size: 12px;">
			<h:outputText value="#{buildingTotal.totalfee}">
					<f:convertNumber pattern="0.00" />
			</h:outputText>
		</td>
		</ui:repeat>
		<td style="width: 30px;border: 1px solid;text-align: center;font-family: simsun;font-size: 12px;">
		<h:outputText value="#{capitalFlowReport.totalFees}">
			<f:convertNumber pattern="0.00" />
		</h:outputText></td>
		</tr>
		</ui:repeat>
		<tr >
		<td style="width: 80px;border: 1px solid;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;" align="left"  colspan="#{fn:length(capitalFlowController.buildings)+2}"><h:outputText value="退费项目"></h:outputText></td>
		</tr>
		<ui:repeat value="#{capitalFlowController.refundTypeReports}" var="capitalFlowReport">
		<tr>
		<td style="width: 80px;border: 1px solid;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;">
		<h:outputText value="#{capitalFlowReport.itemName}"></h:outputText></td>
		<ui:repeat var="buildingTotal" value="#{capitalFlowReport.buildingTotals}">
		<td style="width: 30px;border: 1px solid;text-align: center;font-family: simsun;font-size: 12px;">
			<h:outputText value="#{buildingTotal.totalfee}">
					<f:convertNumber pattern="0.00" />
			</h:outputText>
		</td>
		</ui:repeat>
		<td style="width: 30px;border: 1px solid;text-align: center;font-family: simsun;font-size: 12px;">
		<h:outputText value="#{capitalFlowReport.totalFees}">
			<f:convertNumber pattern="0.00" />
		</h:outputText></td>
		</tr>
		</ui:repeat>
		<tr >
		<td style="width: 80px;border: 1px solid;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;"
			align="left" colspan="#{fn:length(capitalFlowController.buildings)+2}"><h:outputText value="支付类型"></h:outputText></td>
		</tr>
		<ui:repeat value="#{capitalFlowController.paywayReports}" var="capitalFlowReport">
		<tr>
		<td style="width: 80px;border: 1px solid;text-align: center;font-family: simsun;font-size: 16px;font-weight:bold;">
		<h:outputText value="#{capitalFlowReport.itemName}"></h:outputText></td>
		<ui:repeat var="buildingTotal" value="#{capitalFlowReport.buildingTotals}">
		<td style="width: 30px;border: 1px solid;text-align: center;font-family: simsun;font-size: 12px;">
			<h:outputText value="#{buildingTotal.totalfee}">
					<f:convertNumber pattern="0.00" />
			</h:outputText>
		</td>
		</ui:repeat>
		<td style="width: 30px;border: 1px solid;text-align: center;font-family: simsun;font-size: 12px;">
		<h:outputText value="#{capitalFlowReport.totalFees}">
			<f:convertNumber pattern="0.00" />
		</h:outputText></td>
		</tr>
		</ui:repeat>
		</table>
		</h:form>
</td>
		<td valign="top"> 
		<h:form id="pieForm">
		  <br></br>
          <br></br>
          <br></br>
          <br></br>
          <br></br>
          <br></br>
		  <p:pieChart id="itemPursePie" 
			rendered="#{fn:length(capitalFlowController.itemPursePie.data) > 0}"
          	value="#{capitalFlowController.itemPursePie}" 
          	legendPosition="e" 
          	fill="true" 
          	showDataLabels="true"  
            title="缴费项目对比" 
            style="width:380px;height:#{fn:length(capitalFlowController.itemPursePie.data)*27>300?fn:length(capitalFlowController.itemPursePie.data)*27:300}px" />
            <br></br>           
            <p:pieChart id="foodMenuPie" 
            rendered="#{fn:length(capitalFlowController.foodMenuPie.data) > 0}"
          	value="#{capitalFlowController.foodMenuPie}" 
          	legendPosition="e" 
          	fill="true" 
          	showDataLabels="true"  
            title="菜品缴费对比" 
            style="width:380px;height:#{fn:length(capitalFlowController.foodMenuPie.data)*27>300?fn:length(capitalFlowController.foodMenuPie.data)*27:300}px" /> 
          <br></br>
          <p:pieChart id="refundTypePie" 
	        rendered="#{fn:length(capitalFlowController.refundTypePie.data) > 0}"
          	value="#{capitalFlowController.refundTypePie}" 
          	legendPosition="e" 
          	fill="true" 
          	showDataLabels="true"
            title="退费类型对比" 
            style="width:380px;height:280px" /> 
          <br></br>
          <p:pieChart id="paywayPie" 
          	value="#{capitalFlowController.paywayPie}"
          	rendered="#{fn:length(capitalFlowController.paywayPie.data) > 0}"
          	legendPosition="se" 
          	fill="true" 
          	showDataLabels="true"  
            title="缴费类型对比" 
            style="width:380px;height:280px" />  
        </h:form>
   </td>
</tr></table>
		<script type="text/javascript">
		function exportExcelFun() {
			contentExcel = document.getElementById("reportForm").innerHTML;
			parent.exportExcel('capitalflow',contentExcel);
		}
		</script>
	</h:body>
</f:view>
</html>
