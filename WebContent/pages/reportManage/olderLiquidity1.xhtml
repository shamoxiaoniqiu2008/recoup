<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:his="http://centling.his.net/histag"
	xmlns:p="http://primefaces.org/ui">
<f:view contentType="text/html">

	<style>
.ui-panel .ui-panel-content {
	padding: 0em !important;
}

.reportlevel1 {
	width: 80px;
	border: 1px solid;
	text-align: center;
	font-family: simsun;
	font-size: 16px;
	font-weight: bold;
}

.reportlevel2 {
	border: 1px solid;
	text-align: center;
	font-family: simsun;
	font-size: 12px;
}
</style>

	<h:head>
		<title>#{pageConfig.olderLiquidity}</title>


		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/default.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/skin.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/layout.css"></link>
		<link href="#{request.contextPath}/css/css.css" rel="stylesheet"
			type="text/css" />
		<link rel="stylesheet" href="#{request.contextPath}/css/style.css"></link>

		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/ime.js?ver=#{projectConfig.ver}" />
		<h:outputScript library="javax.faces" name="jsf.js" target="head" />
		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/common.js?ver=#{projectConfig.ver}" />
		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/calendar.js?ver=#{projectConfig.ver}" />
	</h:head>
	<script type="text/javascript">
		
	</script>


	<h:body>
		<p:growl id="message" widgetVar="message"></p:growl>
		<p:growl id="messages"></p:growl>
		<h:form id="searchForm" style="display: inline">
			<h:outputText value="起始时间:" style="text-align:right" />
			<p:calendar id="startDate" pattern="yyyy-MM-dd HH:mm"
				value="#{olderLiquidity1Controller.startDate}">
			</p:calendar>
			<h:outputText value="结束时间:" style="text-align:right" />
			<p:calendar id="endDate" pattern="yyyy-MM-dd HH:mm"
				value="#{olderLiquidity1Controller.endDate}">
			</p:calendar>
			<p:commandButton styleClass="commonbtn" value="查询"
				action="#{olderLiquidity1Controller.selectOlderLiquidity}"
				update=":reportForm,:messages" process="@this,startDate,endDate"></p:commandButton>
			<p:commandButton value="导出" styleClass="commonbtn" update=":message"
				ajax="false">
				<p:dataExporter type="xls" target=":reportForm:report"
					fileName="OlderLiquidity" />
			</p:commandButton>
		</h:form>
		<h:form id="reportForm">
			<font style="font-size: 20pt; font-weight: bold">
				&nbsp;&nbsp;&nbsp;&nbsp;
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;老人流动情况一览</font>
			<br></br>
			<br></br>
			<table>
				<tr>
					<td valign="top"><p:dataTable id="report"
							value="#{olderLiquidity1Controller.olderLiquidityReports}"
							var="report" emptyMessage="没有记录" scrollable="true"
							scrollHeight="360" sortBy="flag">
							<p:column id="olderName" style="width: 40px">
								<f:facet name="header">
									<h:outputText value="姓名"></h:outputText>
								</f:facet>
								<h:outputText value="#{report.olderName}"></h:outputText>
							</p:column>
							<p:column id="buildingName" style="width: 30px">
								<f:facet name="header">
									<h:outputText value="大厦"></h:outputText>
								</f:facet>
								<h:outputText value="#{report.buildingName}"></h:outputText>
							</p:column>
							<p:column id="bedName" styleClass="width50">
								<f:facet name="header">
									<h:outputText value="床位名"></h:outputText>
								</f:facet>
								<h:outputText value="#{report.bedName}"></h:outputText>
							</p:column>
							<p:column id="bedTypeName" styleClass="width60">
								<f:facet name="header">
									<h:outputText value="床位等级"></h:outputText>
								</f:facet>
								<h:outputText value="#{report.bedTypeName}"></h:outputText>
							</p:column>
							<p:column id="nurseLevel" style="width: 60px">
								<f:facet name="header">
									<h:outputText value="护理等级"></h:outputText>
								</f:facet>
								<h:outputText value="#{report.nurseLevel}"></h:outputText>
							</p:column>
							<p:column id="nurseName" styleClass="width50">
								<f:facet name="header">
									<h:outputText value="护理员"></h:outputText>
								</f:facet>
								<h:outputText value="#{report.nurseName}">
								</h:outputText>
							</p:column>
							<p:column id="visitDate" headerText="入住时间" styleClass="width70">
								<f:facet name="header">
									<h:outputText value="入住时间"></h:outputText>
								</f:facet>
								<h:outputText value="#{report.visitDate}">
									<f:convertDateTime pattern="yyyy-MM-dd" />
								</h:outputText>
							</p:column>
							<p:column id="leaveDate" headerText="离院时间" styleClass="width70">
								<f:facet name="header">
									<h:outputText value="离院时间"></h:outputText>
								</f:facet>
								<h:outputText value="#{report.leaveDate}">
									<f:convertDateTime pattern="yyyy-MM-dd" />
								</h:outputText>
							</p:column>
							<p:column id="leaveReason" style="width: 90px">
								<f:facet name="header">
									<h:outputText value="离院原因"></h:outputText>
								</f:facet>
								<h:outputText title="#{report.leaveReason}"
									value="#{fn:substring(report.leaveReason,0,7)}#{fn:length(report.leaveReason) gt 7?'..':''}">
								</h:outputText>
							</p:column>
							<p:column id="flag" style="width: 45px">
								<f:facet name="header">
									<h:outputText value="状态"></h:outputText>
								</f:facet>
								<h:outputText value="在院" rendered="#{report.flag == 1}" />
								<h:outputText value="入院" rendered="#{report.flag == 2}" />
								<h:outputText value="出院" rendered="#{report.flag == 3}" />
							</p:column>
							<p:summaryRow
								listener="#{olderLiquidity1Controller.calculateTotal(report.flag)}">
								<p:column colspan="7" style="text-align:right">
									<nobr> <h:outputText value="入院"
										rendered="#{report.flag == 2}" /> <h:outputText value="出院"
										rendered="#{report.flag == 3}" /> <h:outputText value="总人数:"></h:outputText>
									</nobr>
								</p:column>

								<p:column>
									<h:outputText value="#{olderLiquidity1Controller.total}"></h:outputText>
								</p:column>
								<p:column colspan="2">
								</p:column>
							</p:summaryRow>
						</p:dataTable></td>
					<td valign="top"><p:barChart id="bar"
							value="#{olderLiquidity1Controller.bar}"
							style="height:400px;width: 300px" legendPosition="ne"
							legendRows="#{fn:length(olderLiquidity1Controller.bar.series)}"
							title="老人流动情况" min="0"
							max="#{olderLiquidity1Controller.legendCols}" shadow="false"
							animate="true" /></td>
				</tr>
			</table>
		</h:form>
		<script type="text/javascript">
			
		</script>
	</h:body>
</f:view>
</html>
