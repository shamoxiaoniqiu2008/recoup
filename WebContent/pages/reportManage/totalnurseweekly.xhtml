<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:his="http://centling.his.net/histag"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">
<f:view contentType="text/html">

<style>


.reportlevel1 {
	width: 80px;
	border: 1px solid;
	text-align: center;
	font-family: simsun;
	font-size: 16px;
	font-weight:bold;
	
}

.reportlevel3 {
	width: 60px;
	border: 0px ;
	text-align: center;
	font-family: simsun;
	font-size: 16px;
	
}


.reportlevel4 {
	width: 60px;
	border: 0px ;
	text-align: center;
	font-family: simsun;
	font-size: 16px;
	font-weight:bold;
}


.reportlevel2 {
	width: 30px;
	border: 1px solid;
	text-align: center;
	font-family: simsun;
	font-size: 12px;
	
}

.reportnormaltr {
	
}

.ui-panel .ui-panel-content {
	padding: 0em !important;
}
</style>

	<h:head>
		<title>#{pageConfig.totalNurseWeekly}</title>


		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/default.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/skin.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/layout.css"></link>
		<link href="#{request.contextPath}/css/css.css" rel="stylesheet"
			type="text/css" />
		<link rel="stylesheet" href="#{request.contextPath}/css/style.css"></link>

		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/ime.js?ver=#{projectConfig.ver}" />
		<h:outputScript library="javax.faces" name="jsf.js" target="head" />
		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/common.js?ver=#{projectConfig.ver}" />
		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/calendar.js?ver=#{projectConfig.ver}" />
	</h:head>

	<h:body>
	<p:growl id="message" widgetVar="message"></p:growl>
		<p:growl id="messages"></p:growl>
		<h:form id="searchForm" style="display: inline">
		<p:panelGrid columns="10"></p:panelGrid>
		<h:outputText value="年份:" style="text-align:right" />
		<h:selectOneMenu id="selectYear"
			value="#{totalNurseWeeklyController.selectYear}"
			class="ui-inputfield ui-widget ui-state-default ui-corner-all hasDatepicker">
				<f:selectItems value="#{totalNurseWeeklyController.yearList}"
					var="year" 
					itemValue="#{year}"
					itemLabel="#{year}" />
				<p:ajax event="valueChange" process="@this"
					listener="#{totalNurseWeeklyController.initWeekList}"
					update=":weeklyReportForm,:printForm,:searchForm,:messages"></p:ajax>
		</h:selectOneMenu>
		<h:outputText value="周次:" style="text-align:right" />
		<h:selectOneMenu id="selectWeek"
			value="#{totalNurseWeeklyController.selectWeek}"
			class="ui-inputfield ui-widget ui-state-default ui-corner-all hasDatepicker">
				<f:selectItems value="#{totalNurseWeeklyController.weekList}"
					var="week" 
					itemValue="#{week}"
					itemLabel="#{week}" />
				<p:ajax event="valueChange" process="@this,"
					listener="#{totalNurseWeeklyController.initSearchDate}"
					update=":weeklyReportForm,:printForm,:searchForm,:messages"></p:ajax>
		</h:selectOneMenu>
		<h:outputText value="开始日期:" style="text-align:right" />
		<h:inputText id="startDate" class="ui-inputfield ui-widget ui-state-default ui-corner-all hasDatepicker"
			value="#{totalNurseWeeklyController.startDate}" readonly="true" >
			<f:convertDateTime pattern="yyyy-MM-dd" />
		</h:inputText>
		<h:outputText value="结束日期:" style="text-align:right" />
		<h:inputText id="endDate" class="ui-inputfield ui-widget ui-state-default ui-corner-all hasDatepicker"
			value="#{totalNurseWeeklyController.endDate}" readonly="true"  >
			<f:convertDateTime pattern="yyyy-MM-dd" />
		</h:inputText>
		<p:commandButton value="查看" styleClass="commonbtn"
			action="#{totalNurseWeeklyController.view}"
			rendered="#{totalNurseWeeklyController.flag}"
			update=":weeklyReportForm,:printForm,:searchForm,:messages">
		</p:commandButton>
		<p:commandButton value="生成" styleClass="commonbtn"
			action="#{totalNurseWeeklyController.create}"
			rendered="#{!totalNurseWeeklyController.flag and totalNurseWeeklyController.roleFlag}"
			update=":weeklyReportForm,:printForm,:searchForm,:messages">
		</p:commandButton>
		<p:commandButton value="提交" styleClass="commonbtn"
			onstart="clickHiddenButton()"
			rendered="#{totalNurseWeeklyController.roleFlag and totalNurseWeeklyController.weeklyReport.sendFlag == 2}"
			update=":searchForm,:messages">
		</p:commandButton>
		<p:commandButton value="导出" styleClass="commonbtn"
			onclick="exportExcelFun()"
			rendered="#{totalNurseWeeklyController.flag}"
			type="button"
			update=":messages">
		</p:commandButton>
		</h:form>
		<div align="center">
		<h:form id="weeklyReportForm">
		<br></br>
		<br></br>
		<br></br>
		<font style="font-size:20pt;font-weight:bold">总体护理情况周报</font>
		<br></br>
		<br></br>
		<table id="generalDate"
			style="width: 700px;height: 35px;border: 2px solid;border-width:2px 2px 2px 2px">
		<tr >
		<td class="reportlevel1">老人数量</td>
		<td class="reportlevel2">起始</td>
		<td class="reportlevel2">
		<h:outputText id="startOlderNum" value="#{totalNurseWeeklyController.startOlderNum}"></h:outputText>
		</td>
		<td class="reportlevel2">结束</td>
		<td class="reportlevel2">
		<h:outputText id="endOlderNum" value="#{totalNurseWeeklyController.endOlderNum}"></h:outputText>
		</td>
		<td class="reportlevel2">新入住</td>
		<td class="reportlevel2">
		<h:outputText id="newInNum" value="#{totalNurseWeeklyController.newInNum}"></h:outputText>
		</td>
		<td class="reportlevel2">新出院</td>
		<td class="reportlevel2">
		<h:outputText id="newOutNum" value="#{totalNurseWeeklyController.newOutNum}"></h:outputText>
		</td>
		<td class="reportlevel1">护理员</td>
		<td class="reportlevel2">总数</td>
		<td class="reportlevel2">
		<h:outputText id="nurseNum" value="#{totalNurseWeeklyController.nurseNum}"></h:outputText>
		</td>
		<td class="reportlevel2">定岗</td>
		<td class="reportlevel2">
		<h:outputText id="fixedNurseNum" value="#{totalNurseWeeklyController.fixedNurseNum}"></h:outputText>
		</td>
		</tr>
		</table>
		<table style="width: 700px;height: 35px;border:solid;border-width:0px 2px 2px 2px">
		<tr >
		<td class="reportlevel1">老人情况</td>
		<ui:repeat var="olderType" value="#{totalNurseWeeklyController.olderTypes}">
		<td class="reportlevel2">#{olderType.oldertypeName}</td>
		<td class="reportlevel2">#{olderType.num}</td>
		</ui:repeat>
		</tr>
		</table>
		<table style="width: 700px;height: 35px;border: solid;border-width:0px 2px 2px 2px">
		<tr >
		<td class="reportlevel1">意外伤害</td>
		<ui:repeat var="accidentType" value="#{totalNurseWeeklyController.accidentTypes}">
		<td class="reportlevel2">#{accidentType.accidenttypeName}</td>
		<td class="reportlevel2">#{accidentType.num}</td>
		</ui:repeat>
		</tr>
		</table>
		<table style="width: 700px;height: 35px;border: solid;border-width:0px 2px 2px 2px">
		<tr style="width: 700px;height: 35px;border: 1px solid;">
		<td class="reportlevel1">大厦情况</td>
		<ui:repeat var="building" value="#{totalNurseWeeklyController.buildings}">
		<td class="reportlevel2">#{building.name}</td>
		<td class="reportlevel2">#{building.oldernumber}</td>
		</ui:repeat>
		</tr>
		</table>
		<table style="width: 700px;border:solid;border-width:0px 2px 2px 2px">
		<tr style="width: 700px;height: 90px;border: 1px solid;">
		<td class="reportlevel1">活动及大事记</td>
		<td >
			<p:inputTextarea value="#{totalNurseWeeklyController.weeklyReport.events}" id="events"
				readonly="#{totalNurseWeeklyController.weeklyReport.sendFlag == 1}"
				style="width: 620px;height: 80px">
			</p:inputTextarea>
		</td>
		</tr>
		<tr style="width: 700px;height: 90px;border: 1px solid;">
		<td class="reportlevel1">伙食及生活情况</td>
		<td ><p:inputTextarea value="#{totalNurseWeeklyController.weeklyReport.meals}" id="meals"
			readonly="#{totalNurseWeeklyController.weeklyReport.sendFlag == 1}"
				style="width: 620px;height: 80px">
			</p:inputTextarea></td>
		</tr>
		<tr style="width: 700px;height: 90px;border: 1px solid;">
		<td class="reportlevel1">老人情况</td>
		<td ><p:inputTextarea value="#{totalNurseWeeklyController.weeklyReport.olderCondition}"
			readonly="#{totalNurseWeeklyController.weeklyReport.sendFlag == 1}"
			style="width: 620px;height: 80px" id="olderCondition">
		</p:inputTextarea></td>
		</tr>
		<tr style="width: 700px;height: 90px;border: 1px solid;">
		<td class="reportlevel1">员工情况</td>
		<td ><p:inputTextarea value="#{totalNurseWeeklyController.weeklyReport.employeeCondition}" 
				readonly="#{totalNurseWeeklyController.weeklyReport.sendFlag == 1}"
				style="width: 620px;height: 80px" id="employeeCondition"></p:inputTextarea></td>
		</tr>
		<tr style="width: 700px;height: 90px;border: 1px solid;">
		<td class="reportlevel1">存在问题及解决办法</td>
		<td ><p:inputTextarea value="#{totalNurseWeeklyController.weeklyReport.problemAndsolve}" 
				readonly="#{totalNurseWeeklyController.weeklyReport.sendFlag == 1}"
				style="width: 620px;height: 80px" id="problemAndsolve">
			</p:inputTextarea></td>
		</tr>
		<tr style="width: 700px;height: 90px;border: 1px solid;">
		<td class="reportlevel1">本周工作完成情况</td>
		<td ><p:inputTextarea value="#{totalNurseWeeklyController.weeklyReport.thisweekSum}" id="thisweekSum"
				readonly="#{totalNurseWeeklyController.weeklyReport.sendFlag == 1}"
				style="width: 620px;height: 80px">
			</p:inputTextarea></td>
		</tr>
		<tr style="width: 700px;height: 90px;border: 1px solid;">
		<td class="reportlevel1">工作计划</td>
		<td ><p:inputTextarea value="#{totalNurseWeeklyController.weeklyReport.nextweekPlan}" id="nextweekPlan"
				readonly="#{totalNurseWeeklyController.weeklyReport.sendFlag == 1}"
				style="width: 620px;height: 80px">
			</p:inputTextarea></td>
		</tr>
		<tr style="width: 700px;height: 90px;border: 1px solid;">
		<td class="reportlevel1">需要管委会解决</td>
		<td ><p:inputTextarea value="#{totalNurseWeeklyController.weeklyReport.assistsolveProblem}" id="assistsolveProblem"
				readonly="#{totalNurseWeeklyController.weeklyReport.sendFlag == 1}"
				style="width: 620px;height: 80px">
			</p:inputTextarea></td>
		</tr>
		<tr style="width: 700px;height: 90px;border: 1px solid;">
		<td class="reportlevel1">建议</td>
		<td ><p:inputTextarea value="#{totalNurseWeeklyController.weeklyReport.suggestion}" id="suggestion"
				readonly="#{totalNurseWeeklyController.weeklyReport.sendFlag == 1}"
				style="width: 620px;height: 80px">
			</p:inputTextarea></td>
		</tr>
		</table>
		<table style="width: 700px;height: 35px;border: 2px solid;border-width:0px 2px 2px 2px">
		<tr style="width: 700px;height: 35px;border: 1px solid;">
		<label class="reportlevel4" >制表人:</label>
		<h:outputText value="#{totalNurseWeeklyController.weeklyReport.employeeName}&nbsp;&nbsp;" class="reportlevel3"></h:outputText>
		<label class="reportlevel4" >制表日期:</label>
		<h:outputText value="#{totalNurseWeeklyController.weeklyReport.createdate}"
			class="reportlevel3">
			<f:convertDateTime pattern="yyyy-MM-dd" />
		</h:outputText>
		<label class="reportlevel4">&nbsp;&nbsp;报表时段：</label>
		<h:outputText value="#{totalNurseWeeklyController.weeklyReport.startTime}"
			class="reportlevel3">
			<f:convertDateTime pattern="yyyy-MM-dd" />
		</h:outputText>
		<label class="reportlevel4">--</label>
		<h:outputText value="#{totalNurseWeeklyController.weeklyReport.endTime}"
			class="reportlevel3">
			<f:convertDateTime pattern="yyyy-MM-dd" />
		</h:outputText>
		</tr>
		</table>
		<p:commandButton style="VISIBILITY: hidden" value=""  id="hiddenButton"
			action="#{totalNurseWeeklyController.check}"
			oncomplete="afterCheck(xhr, status, args)"
			update=":messages">
		</p:commandButton>
		</h:form>
		</div>
		<h:form style="display:none;" id="printForm">
		
	<table cellspacing="0" cellpadding="0">
	<table width="800" border="1">
	<tr>
	<td align="center">

		<font style="font-size:20pt;font-weight:bold">
		总体护理情况周报(#{totalNurseWeeklyController.selectYear}年
		第#{totalNurseWeeklyController.selectWeek}周)</font>
	</td>
	</tr>
	<tr>
	<td>
		<table BORDER="1" bordercolordark="#000000" bordercolorlight="#ffffff">
		<tr >
		<td class="reportlevel1">老人数量</td>
		<td class="reportlevel2">起始</td>
		<td class="reportlevel2">
		<h:outputText id="startOlderNum" value="#{totalNurseWeeklyController.startOlderNum}"></h:outputText>
		</td>
		<td class="reportlevel2">结束</td>
		<td class="reportlevel2">
		<h:outputText id="endOlderNum" value="#{totalNurseWeeklyController.endOlderNum}"></h:outputText>
		</td>
		<td class="reportlevel2">新入住</td>
		<td class="reportlevel2">
		<h:outputText id="newInNum" value="#{totalNurseWeeklyController.newInNum}"></h:outputText>
		</td>
		<td class="reportlevel2">新出院</td>
		<td class="reportlevel2">
		<h:outputText id="newOutNum" value="#{totalNurseWeeklyController.newOutNum}"></h:outputText>
		</td>
		<td class="reportlevel1">护理员</td>
		<td class="reportlevel2">总数</td>
		<td class="reportlevel2">
		<h:outputText id="nurseNum" value="#{totalNurseWeeklyController.nurseNum}"></h:outputText>
		</td>
		<td class="reportlevel2">定岗</td>
		<td class="reportlevel2">
		<h:outputText id="fixedNurseNum" value="#{totalNurseWeeklyController.fixedNurseNum}"></h:outputText>
		</td>
		</tr>
		</table>
	</td>
	</tr>
	<tr>
	<td>
		<table  BORDER="1" bordercolordark="#000000" bordercolorlight="#ffffff">
		<tr >
		<td class="reportlevel1">老人情况</td>
		<ui:repeat var="olderType" value="#{totalNurseWeeklyController.olderTypes}">
		<td class="reportlevel2">#{olderType.oldertypeName}</td>
		<td class="reportlevel2">#{olderType.num}</td>
		</ui:repeat>
		</tr>
		</table>
		
		
</td>
	</tr>
	<tr>
	<td>
		<table  BORDER="1" bordercolordark="#000000" bordercolorlight="#ffffff">
		<tr >
		<td class="reportlevel1">意外伤害</td>
		<ui:repeat var="accidentType" value="#{totalNurseWeeklyController.accidentTypes}">
		<td class="reportlevel2">#{accidentType.accidenttypeName}</td>
		<td class="reportlevel2">#{accidentType.num}</td>
		</ui:repeat>
		</tr>
		</table>
		
</td>
	</tr>
	<tr>
	<td>
	
		<table  BORDER="1" bordercolordark="#000000" bordercolorlight="#ffffff">
		<tr>
		<td class="reportlevel1">大厦情况</td>
		<ui:repeat var="building" value="#{totalNurseWeeklyController.buildings}">
		<td class="reportlevel2">#{building.name}</td>
		<td class="reportlevel2">#{building.oldernumber}</td>
		</ui:repeat>
		</tr>
		</table>
		
</td>
	</tr>
	<tr>
	<td>
	
	<table  BORDER="1" bordercolordark="#000000" bordercolorlight="#ffffff">
		<tr style="height: 90px;">
		<td class="reportlevel1">活动及大事记</td>
		<td colspan="#{totalNurseWeeklyController.maxNumAto*2}">
			#{totalNurseWeeklyController.weeklyReport.events}
		</td>
		</tr>
		<tr style="height: 90px;">
		<td class="reportlevel1">伙食及生活情况</td>
		<td colspan="#{totalNurseWeeklyController.maxNumAto*2}" valign="top">#{totalNurseWeeklyController.weeklyReport.meals}&nbsp;</td>
		</tr>
		<tr style="height: 90px;">
		<td class="reportlevel1">老人情况</td>
		<td colspan="#{totalNurseWeeklyController.maxNumAto*2}" valign="top">#{totalNurseWeeklyController.weeklyReport.olderCondition}&nbsp;</td>
		</tr>
		<tr style="height: 90px;">
		<td class="reportlevel1">员工情况</td>
		<td colspan="#{totalNurseWeeklyController.maxNumAto*2}" valign="top">#{totalNurseWeeklyController.weeklyReport.employeeCondition}&nbsp;</td>
		</tr>
		<tr style="height: 90px;">
		<td class="reportlevel1">存在问题及解决办法</td>
		<td colspan="#{totalNurseWeeklyController.maxNumAto*2}" valign="top">#{totalNurseWeeklyController.weeklyReport.problemAndsolve}&nbsp; </td>
		</tr>
		<tr style="height: 90px;">
		<td class="reportlevel1">本周工作完成情况</td>
		<td colspan="#{totalNurseWeeklyController.maxNumAto*2}" valign="top">#{totalNurseWeeklyController.weeklyReport.thisweekSum}&nbsp;</td>
		</tr>
		<tr style="height: 90px;">
		<td class="reportlevel1">工作计划</td>
		<td colspan="#{totalNurseWeeklyController.maxNumAto*2}" valign="top">#{totalNurseWeeklyController.weeklyReport.nextweekPlan}&nbsp;</td>
		</tr>
		<tr style="height: 90px;">
		<td class="reportlevel1">需要管委会解决</td>
		<td colspan="#{totalNurseWeeklyController.maxNumAto*2}" valign="top">#{totalNurseWeeklyController.weeklyReport.assistsolveProblem}&nbsp;</td>
		</tr>
		<tr style="height: 90px;">
		<td class="reportlevel1">建议</td>
		<td colspan="#{totalNurseWeeklyController.maxNumAto*2}" valign="top">#{totalNurseWeeklyController.weeklyReport.suggestion}&nbsp; </td>
		</tr>
		</table>
		
</td>
	</tr>
	<tr>
	<td>
		<table style="width: 700px;height: 35px;border: 2px solid;border-width:0px 2px 2px 2px">
		<tr style="width: 700px;height: 35px;border: 1px solid;">
		<label class="reportlevel4" >制表人:</label>
		<h:outputText value="#{totalNurseWeeklyController.weeklyReport.employeeName}" class="reportlevel3"></h:outputText>
		
		<label class="reportlevel4" >制表日期:</label>
		<h:outputText value="#{totalNurseWeeklyController.weeklyReport.createdate}"
			class="reportlevel3">
			<f:convertDateTime pattern="yyyy-MM-dd" />
		</h:outputText>
		<label class="reportlevel4">报表时段：</label>
		<h:outputText value="#{totalNurseWeeklyController.weeklyReport.startTime}"
			class="reportlevel3">
			<f:convertDateTime pattern="yyyy-MM-dd" />
		</h:outputText>
		<label class="reportlevel4">--</label>
		<h:outputText value="#{totalNurseWeeklyController.weeklyReport.endTime}"
			class="reportlevel3">
			<f:convertDateTime pattern="yyyy-MM-dd" />
		</h:outputText>
		</tr>
		</table>
		

		</td>
	</tr>
	</table>	
	</table>
		</h:form>
		<p:confirmDialog message="统计数据没有包含本周剩下的天数,确认保存?" severity="alert"
			widgetVar="confirm" appendTo="@(body)">
			<h:form>
				<p:commandButton styleClass="submitbtn" value=""
					style="margin-left:80px;"
					actionListener="#{totalNurseWeeklyController.save}"
					update=":messages" ajax="true"
					oncomplete="confirm.hide()" />
				<p:commandButton styleClass="cancelbtn" value=""
					onclick="confirm.hide()" type="button" />
			</h:form>
		</p:confirmDialog>
		
		<script type="text/javascript">
		function clickHiddenButton(){
			jQuery("#weeklyReportForm\\:hiddenButton").click();
		}
		function exportExcelFun() {
			contentExcel = document.getElementById("printForm").innerHTML;
			parent.exportExcel('weeklyReport',contentExcel);
		}
		function afterCheck(xhr, status, args) {
			if (args.validate) {
				confirm.show();
			}
		}
		</script>
	</h:body>
</f:view>
</html>
