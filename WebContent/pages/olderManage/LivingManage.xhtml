<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:his="http://centling.his.net/histag"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">

<style>
.ui-chkbox-box {
	margin-bottom: -4px;
}
</style>
<f:view contentType="text/html">
	<h:head>
		<title>#{pageConfig.loginTitle}</title>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/default.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/skin.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/layout.css"></link>
		<link href="#{request.contextPath}/css/css.css" rel="stylesheet"
			type="text/css" />
		<link rel="stylesheet" href="#{request.contextPath}/css/style.css"></link>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/ime.js?ver=#{projectConfig.ver}" />
		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/common.js?ver=#{projectConfig.ver}" />
		<h:outputScript library="javax.faces" name="jsf.js" target="head" />
		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/calendar.js?ver=#{projectConfig.ver}" />
	</h:head>
	<style>
.B1 {
	background-color: green
}

.B2 {
	background-color: red
}
</style>
	<h:body>
		<p:growl id="message"></p:growl>
		<h:form id="searchForm">
			<table>
				<tr>
					<td class="leftcell">老人姓名:</td>
					<td><p:inputText id="olderName" style="width:145px;"
							value="#{livingManageController.olderName}" /> <his:IME
							for="searchForm:olderName" rawSQL="true"
							SQL="#{livingManageController.olderSQL}" fitcol="inputCode"
							multiresult="searchForm:olderId;0" sortcol="olderId"
							SQLResult="编号:0,姓名:1,输入码:2,大厦:6,楼层:5,房间:4,床位:3" resultcol="1"
							lock="true" /> <h:inputHidden
							value="#{livingManageController.olderId}" id="olderId" /></td>
					<td class="leftcell">入住日期:</td>
					<td><p:calendar value="#{livingManageController.startDate}"
							style="width:145px;" pattern="yyyy-MM-dd"></p:calendar></td>
					<td class="leftcell">至:</td>
					<td><p:calendar value="#{livingManageController.endDate}"
							style="width:145px;" pattern="yyyy-MM-dd"></p:calendar></td>
					<td class="leftcell"><p:commandButton styleClass="searchbtn"
							value=""
							actionListener="#{livingManageController.searchLivingRecords}"
							update=":olderLivingForm,:message" /></td>
					<td class="leftcell"><p:commandButton
							actionListener="#{livingManageController.clearSearchForm}"
							update=":searchForm" styleClass="blankbtn" value="" /></td>

				</tr>
			</table>
		</h:form>
		<h:form id="olderLivingForm">
			<div style="width: 1140px;">
				<table width="100%">
					<tr>
						<td><p:dataTable cellspacing="2" rows="10" style="width:100%"
								id="olderLivingTable"
								selection="#{livingManageController.selectedRow}"
								value="#{livingManageController.livingRecordList}"
								paginator="true" paginatorPosition="bottom"
								paginatorAlwaysVisible="false"
								paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
								var="record" rowKey="#{record.id}" selectionMode="single"
								emptyMessage="没有相应记录">
								<p:ajax event="rowSelect"
									listener="#{livingManageController.selectRow}" />
								<p:ajax event="rowUnselect"
									listener="#{livingManageController.setUnableFlag}" />
								<p:column headerText="编号" styleClass="width50">
									<h:outputText value="#{record.olderId}">
									</h:outputText>
								</p:column>
								<p:column headerText="合同号" styleClass="width50">
									<h:outputText value="#{record.contractnum}">
									</h:outputText>
								</p:column>
								<p:column headerText="姓名" styleClass="width50">
									<h:outputText value="#{record.olderName}" />
								</p:column>
								<p:column headerText="性别" styleClass="width50">
									<h:outputText value="男" rendered="#{record.sex==1}" />
									<h:outputText value="女" rendered="#{record.sex==2}" />
								</p:column>
								<p:column headerText="民族" styleClass="width50">
									<h:outputText value="#{record.nationName}" />
								</p:column>
								<p:column headerText="入住日期" styleClass="width80">
									<h:outputText value="#{record.visittime}">
										<f:convertDateTime pattern="yyyy-MM-dd"></f:convertDateTime>
									</h:outputText>
								</p:column>
								<p:column headerText="状态" styleClass="width50">
									<h:outputText value="入住" rendered="#{record.statuses==3}" />
									<h:outputText value="请假" rendered="#{record.statuses==4}" />
									<h:outputText value="离院" rendered="#{record.statuses==5}" />
									<h:outputText value="结算" rendered="#{record.statuses==6}" />
								</p:column>
								<p:column headerText="类型" styleClass="width60">
									<h:outputText value="自理" rendered="#{record.types==1}" />
									<h:outputText value="半自理" rendered="#{record.types==2}" />
									<h:outputText value="不能自理" rendered="#{record.types==3}" />
								</p:column>
								<p:column headerText="护理级别" styleClass="width60">
									<h:outputText value="#{record.nurseLevel}" />
								</p:column>
								<p:column headerText="床位标准" styleClass="width130">
									<h:outputText value="#{record.bedType}" />
								</p:column>
								<p:column headerText="大厦" styleClass="width50">
									<h:outputText value="#{record.buildName}" />
								</p:column>
								<p:column headerText="楼层" styleClass="width60">
									<h:outputText value="#{record.floorName}" />
								</p:column>
								<p:column headerText="房间" styleClass="width50">
									<h:outputText value="#{record.roomName}" />
								</p:column>
								<p:column headerText="床位" styleClass="width60">
									<h:outputText value="#{record.bedName}" />
								</p:column>
							</p:dataTable></td>
					</tr>
				</table>
			</div>
		</h:form>
		<!-- 申请信息维护 -->
		<h:form id="maintainForm">

			<div align="center">
				<p:commandButton oncomplete="addLivingDialogShow(xhr,status,args)"
					id="addButton"
					actionListener="#{livingManageController.showAddForm}"
					styleClass="addbtn" value="" update=":addForm,:message"></p:commandButton>
				<p:commandButton oncomplete="addLivingDialogShow(xhr,status,args)"
					id="editButton"
					actionListener="#{livingManageController.showEditForm}"
					update=":addForm,:message" styleClass="modifybtn" value=""></p:commandButton>
				<p:commandButton id="confirmNoticeButton" value="发送入住通知"
					actionListener="#{livingManageController.confirmSend}"
					styleClass="commonbtn" update=":message"></p:commandButton>
			</div>
		</h:form>

		<p:dialog header="家属信息" widgetVar="addFamilyDialog" position="center"
			resizable="false" appendTo="@(body)" modal="true">
			<h:form id="addFamilyForm">
				<table class="hengbiaoge" width="650px" align="center">
					<tr>
						<td class="hengbiaogeHeader1"><h:outputText value="姓名:"
								styleClass="redfont" /></td>
						<td class="hengbiaogedata"><p:inputText required="true"
								requiredMessage="家属姓名不能为空"
								value="#{livingManageController.addFamily.name}">
							</p:inputText></td>
						<td class="hengbiaogeHeader1"><h:outputText value="性别:" /></td>
						<td class="hengbiaogedata"><h:selectOneMenu
								style="width:150px"
								class="ui-inputfield ui-widget ui-state-default ui-corner-all hasDatepicker ui-state-hover"
								value="#{livingManageController.addFamily.sex}">
								<f:selectItem itemValue="1" itemLabel="男" />
								<f:selectItem itemValue="2" itemLabel="女" />
							</h:selectOneMenu></td>
					</tr>
					<tr>
						<td class="hengbiaogeHeader1"><h:outputText value="关系:"
								styleClass="redfont" /></td>
						<td class="hengbiaogedata"><h:selectOneMenu
								style="width:150px"
								class="ui-inputfield ui-widget ui-state-default ui-corner-all hasDatepicker ui-state-hover"
								value="#{livingManageController.addFamily.relationship}">
								<f:selectItems value="#{livingManageController.relationDicList}"
									var="relation" rowKey="#{relation.id}"
									itemLabel="#{relation.relationship}" itemValue="#{relation.id}" />
							</h:selectOneMenu></td>
						<td class="hengbiaogeHeader1"><h:outputText value="联系电话1:"
								styleClass="redfont" /></td>
						<td class="hengbiaogedata"><p:inputText required="true"
								requiredMessage="联系电话1不能为空" validatorMessage="联系电话1格式不正确"
								value="#{livingManageController.addFamily.phonenum1}">
								<f:validateRegex pattern="((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)" />
							</p:inputText></td>
					</tr>
					<tr>
						<td class="hengbiaogeHeader1"><h:outputText value="联系电话2:" /></td>
						<td class="hengbiaogedata"><p:inputText
								validatorMessage="联系电话2格式不正确"
								value="#{livingManageController.addFamily.phonenum2}">
								<f:validateRegex pattern="((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)" />
							</p:inputText></td>
						<td class="hengbiaogeHeader1"><h:outputText value="身份证号:" /></td>
						<td class="hengbiaogedata"><p:inputText
								value="#{livingManageController.addFamily.idcard}">
							</p:inputText></td>
					</tr>
					<tr>
						<td class="hengbiaogeHeader1"><h:outputText value="单位:" /></td>
						<td class="hengbiaogedata"><p:inputText
								value="#{livingManageController.addFamily.company}">
							</p:inputText></td>
						<td class="hengbiaogeHeader1"><h:outputText value="住址:" /></td>
						<td class="hengbiaogedata"><p:inputText
								value="#{livingManageController.addFamily.address}">
							</p:inputText></td>
					</tr>
					<tr>
						<td class="hengbiaogeHeader1"><h:outputText value="紧急" /></td>
						<td class="hengbiaogedata"><h:selectBooleanCheckbox
								value="#{livingManageController.addFamily.defaultFamily}" /></td>
						<td class="hengbiaogeHeader1"><h:outputText value="备注" /></td>
						<td class="hengbiaogedata"><p:inputText
								value="#{livingManageController.addFamily.notes}">
							</p:inputText></td>
					</tr>
				</table>
				<h:panelGrid id="buttonGrid" columns="3" style="margin:0px auto">
					<p:commandButton
						actionListener="#{livingManageController.saveRelationshipRecord}"
						oncomplete="addFamilyDialogHide(xhr,status,args)" value=""
						styleClass="submitbtn"
						update=":addForm:tabView:famlyTable,:addFamilyForm,:message">
					</p:commandButton>
					<p:commandButton styleClass="blankbtn" process="@this"
						actionListener="#{livingManageController.initFamily}"
						update=":addFamilyForm" value=""
						disabled="#{livingManageController.blankRelationFlag}" />
					<p:commandButton onclick="addFamilyDialog.hide()"
						styleClass="commonbtn" value="关闭" />
				</h:panelGrid>
			</h:form>
		</p:dialog>
		<!-- 新增入住信息 -->
		<p:dialog header="老人入住" widgetVar="addLivingDialog" position="top"
			resizable="false" appendTo="@(body)" modal="true">
			<h:form id="addForm" styleClass="noDisable">
				<p:tabView style="height:300px;" id="tabView">
					<p:tab title="老人入住信息">
						<table class="hengbiaoge" width="650px" align="center">
							<tr>
								<td class="hengbiaogeHeader1"><h:outputText value="合同号:" /></td>
								<td class="hengbiaogedata"><p:inputText
										value="#{livingManageController.addLivingOlder.contractnum}">
									</p:inputText></td>
								<td class="hengbiaogeHeader1"><h:outputText value="入住时间:"
										styleClass="redfont" /></td>
								<td class="hengbiaogedata"><p:calendar required="true"
										requiredMessage="入住时间不可为空"
										value="#{livingManageController.addLivingOlder.visittime}"
										pattern="yyyy-MM-dd HH:mm" showButtonPanel="true"></p:calendar></td>
							</tr>
							<tr>
								<td class="hengbiaogeHeader1"><h:outputText value="状态:" /></td>
								<td class="hengbiaogedata"><h:selectOneMenu
										disabled="#{livingManageController.addOlderStatuseFlag}"
										style="width:150px"
										class="ui-inputfield ui-widget ui-state-default ui-corner-all hasDatepicker ui-state-hover"
										value="#{livingManageController.addLivingOlder.statuses}">
										<f:selectItem itemValue="3" itemLabel="入住" />
										<f:selectItem itemValue="4" itemLabel="请假" />
										<f:selectItem itemValue="5" itemLabel="离院" />
										<f:selectItem itemValue="6" itemLabel="结算" />
									</h:selectOneMenu></td>
								<td class="hengbiaogeHeader1"><h:outputText value="老人姓名:"
										styleClass="redfont" /></td>
								<td class="hengbiaogedata"><p:inputText required="true"
										requiredMessage="老人姓名不能为空" id="olderName"
										disabled="#{livingManageController.olderNameFlag}"
										value="#{livingManageController.addLivingOlder.olderName}">
									</p:inputText> <his:IME for="addForm:tabView:olderName" rawSQL="true"
										SQL="#{livingManageController.addOlderSQL}" fitcol="inputCode"
										multiresult="addForm:tabView:olderName;1,addForm:tabView:olderId;0,addForm:tabView:applyId;4"
										SQLResult="编号:0,姓名:1,输入码:2,状态:3,申请编号:4:hide,养老类别:5"
										resultcol="1" lock="false" sortcol="id" /> <h:inputHidden
										value="#{livingManageController.addLivingOlder.olderId}"
										id="olderId" /> <h:inputHidden
										value="#{livingManageController.addLivingOlder.applyId}"
										id="applyId" /></td>
							</tr>
							<tr>
								<td class="hengbiaogeHeader1"><h:outputText value="护理级别:"
										styleClass="redfont" /></td>
								<td class="hengbiaogedata"><p:inputText required="true"
										id="nurseLevel" requiredMessage="护理级别不能为空"
										value="#{livingManageController.addLivingOlder.nurseLevel}">
									</p:inputText> <his:IME for="addForm:tabView:nurseLevel" rawSQL="true"
										SQL="#{livingManageController.nurseLevelSQL}"
										fitcol="inputCode" sortcol="id"
										multiresult="addForm:tabView:nurseLevel;1,addForm:tabView:nurselevelId;0,addForm:tabView:nurseItemId;4"
										SQLResult="编号:0:hide,级别:1,输入码:2:hide,费用:3:hide,护理价表ID:4:hide,套餐内容:5"
										resultcol="1" lock="false" /> <h:inputHidden
										value="#{livingManageController.addLivingOlder.nurseLevelId}"
										id="nurselevelId" /> <h:inputHidden
										value="#{livingManageController.nurseItemId}" id="nurseItemId" />
								</td>
								<td class="hengbiaogeHeader1"><h:outputText value="床位号:"
										styleClass="redfont" /></td>
								<td class="hengbiaogedata"><p:inputText
										value="#{livingManageController.addLivingOlder.bedName}"
										id="bedName" style="width:79px">
										<p:ajax event="focus" process="@this"
											listener="#{livingManageController.initBedList}"
											oncomplete="bedDialog.show()" update=":bedForm"></p:ajax>
									</p:inputText> <h:inputHidden required="true" requiredMessage="床位号不可为空!"
										value="#{livingManageController.addLivingOlder.bedId}"
										id="bedId" /> <h:outputText value="不计费:" /> <p:selectBooleanCheckbox
										value="#{livingManageController.bedUseFlag}"></p:selectBooleanCheckbox></td>
							</tr>
							<tr>
								<td class="hengbiaogeHeader1"><h:outputText value="床位标准:" /></td>
								<td class="hengbiaogedata"><p:inputText required="true"
										disabled="true" id="bedType" requiredMessage="床位标准不能为空"
										value="#{livingManageController.addLivingOlder.bedType}">
									</p:inputText> <h:inputHidden
										value="#{livingManageController.addLivingOlder.bedTypeId}"
										id="bedTypeId" /></td>
								<td class="hengbiaogeHeader1"><h:outputText value="护理员:"
										styleClass="redfont" /></td>
								<td class="hengbiaogedata"><p:inputText required="true"
										id="nurseName" requiredMessage="护理员不能为空"
										value="#{livingManageController.addLivingOlder.nurseName}">
									</p:inputText> <his:IME for="addForm:tabView:nurseName" rawSQL="true"
										fitcol="inputCode" SQL="#{livingManageController.nurseSQL}"
										sortcol="id" SQLResult="编号:0,姓名:1,输入码:2" resultcol="1"
										lock="true" multiresult="addForm:tabView:nurseId;0" /> <h:inputHidden
										value="#{livingManageController.addLivingOlder.nurseId}"
										id="nurseId" /></td>
							</tr>
							<tr>
								<td class="hengbiaogeHeader1"><h:outputText value="医疗保险:" /></td>
								<td class="hengbiaogedata"><h:selectOneMenu
										style="width:150px"
										class="ui-inputfield ui-widget ui-state-default ui-corner-all hasDatepicker ui-state-hover"
										value="#{livingManageController.addLivingOlder.insurance}">
										<f:selectItem itemValue="自费" itemLabel="自费" />
										<f:selectItem itemValue="省医疗保险" itemLabel="省医疗保险" />
										<f:selectItem itemValue="市医疗保险" itemLabel="市医疗保险" />
										<f:selectItem itemValue="城镇居民医疗保险" itemLabel="城镇居民医疗保险" />
										<f:selectItem itemValue="新农合医疗保险" itemLabel="新农合医疗保险" />
									</h:selectOneMenu></td>
								<td class="hengbiaogeHeader1"><h:outputText value="办理人:" /></td>
								<td class="hengbiaogedata"><p:inputText disabled="true"
										value="#{livingManageController.userName}" /></td>
							</tr>
							<tr>
								<td class="hengbiaogeHeader1"><h:outputText value="备注:" /></td>
								<td class="hengbiaogedata" colspan="3"><p:inputText
										style="width:471px"
										value="#{livingManageController.addLivingOlder.notes}" /></td>
							</tr>
						</table>
						<h:panelGrid id="buttonGrid" columns="3" style="margin:0px auto">
							<p:commandButton
								action="#{livingManageController.saveLivingRecord}"
								oncomplete="addConfirm(xhr,status,args)" styleClass="submitbtn"
								value="" update=":olderLivingForm:olderLivingTable,:message">
							</p:commandButton>
							<p:commandButton styleClass="blankbtn" value="" process="@this"
								actionListener="#{livingManageController.clearAddForm}"
								update=":addForm" disabled="#{livingManageController.blankFlag}" />
							<p:commandButton onclick="addLivingDialog.hide()"
								styleClass="cancelbtn" value="" />
						</h:panelGrid>
					</p:tab>
					<p:tab title="家属信息">
						<table class="hengbiaoge" width="700px" align="center">
							<tr>
								<td><p:dataTable rows="6" style="width:100%"
										id="famlyTable"
										selection="#{livingManageController.selectedFamilyRow}"
										value="#{livingManageController.familyList}" paginator="true"
										paginatorPosition="bottom" paginatorAlwaysVisible="false"
										paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
										var="family" rowKey="#{family.name}" selectionMode="single"
										emptyMessage="没有相应记录">
										<p:ajax event="rowSelect"
											listener="#{livingManageController.selectFamilyRow}"></p:ajax>
										<p:ajax event="rowUnselect"
											listener="#{livingManageController.unselectFamilyRow}"></p:ajax>
										<p:column headerText="姓名" styleClass="width50">
											<h:outputText value="#{family.name}">
											</h:outputText>
										</p:column>
										<p:column headerText="性别" styleClass="width50">
											<h:outputText value="男" rendered="#{family.sex==1}" />
											<h:outputText value="女" rendered="#{family.sex==2}" />
										</p:column>
										<p:column headerText="关系" styleClass="width50">
											<h:outputText value="#{family.relationShipStr}" />
										</p:column>
										<p:column headerText="联系电话1" styleClass="width70">
											<h:outputText value="#{family.phonenum1}">
											</h:outputText>
										</p:column>
										<p:column headerText="联系电话2" styleClass="width70">
											<h:outputText value="#{family.phonenum2}">
											</h:outputText>
										</p:column>
										<p:column headerText="身份证号" styleClass="width60">
											<h:outputText value="#{family.idcard}">
											</h:outputText>
										</p:column>
										<p:column headerText="工作单位" styleClass="width60">
											<h:outputText value="#{family.company}" />
										</p:column>
										<p:column headerText="住址" styleClass="width60">
											<h:outputText value="#{family.address}" />
										</p:column>
										<p:column headerText="紧急" styleClass="width50">
											<h:selectBooleanCheckbox value="#{family.defaultFamily}"
												disabled="true" />
										</p:column>
									</p:dataTable></td>
							</tr>
						</table>
						<h:panelGrid columns="3" style="margin:0px auto">
							<p:commandButton process="@this,"
								actionListener="#{livingManageController.initFamily}" value=""
								oncomplete="addFamilyDialog.show()" styleClass="addbtn"
								update=":addFamilyForm,:message">
							</p:commandButton>
							<p:commandButton
								oncomplete="addFamilyDialogshow(xhr,status,args)" value=""
								actionListener="#{livingManageController.showEditFamily}"
								update=":addFamilyForm,:message" styleClass="modifybtn"></p:commandButton>
							<p:commandButton value="删除" process="@this"
								actionListener="#{livingManageController.delFamily}"
								update=":addForm:tabView:famlyTable,:message"
								styleClass="commonbtn"></p:commandButton>
						</h:panelGrid>
					</p:tab>
				</p:tabView>
			</h:form>
		</p:dialog>

		<!--选择床位的dialog add by wensy 2014-01-23-->
		<p:dialog appendTo="@(body)" modal="true" header="选择床位"
			widgetVar="bedDialog" resizable="true">
			<div style="width:850px; height:450px;overflow: scroll; ">
			<h:form id="bedForm">
				<p:tabView id="bedTabView" var="build" dynamic="true" style="height:800px;"
					value="#{livingManageController.buildList}" >
					<p:tab id="playerTab" title="#{build.name}">
						<ui:repeat var="floor" value="#{build.floorList}"
							varStatus="varStatus">
							<table class="hengbiaoge" width="800px" align="center">
								<tr>
									<td><h:outputText value="#{floor.name}" /></td>
								</tr>
							</table>
							<ui:repeat var="bed" value="#{floor.bedList}"
								varStatus="varStatus">
								<table class="biaoge" width="117" border="0" cellpadding="0"
									cellspacing="0"
									style="float: left; height: 130px; margin-left: 1px; margin-top: 1px; border-collapse: collapse">
									<tr>
										<td colspan="2" class="rightHeadingCell1"
											style="varStatus .even?'background: url(../../images/yilankabtn1.gif) ':' background:  url(../../images/yilankabtn4.jpg)'">
											<table width="100%" border="0" cellspacing="0"
												cellpadding="0"
												style="color: #000000; font-size: 15px; font-weight: bold;">
												<tr>
													<td align="center" width="15%"
														style="background-color: #{bed.oldernumber== 2?'red':null} #{bed.oldernumber == 1?'hotpink':null} #{bed.oldernumber  == 0?'cornflowerblue':null}">
														#{bed.sortid}</td>
													<td width="21%" align="right" class="blue"><p:commandLink
															value="选择" process="@this,:bedForm"
															oncomplete="hideBtnClick()"
															rendered="#{!(bed.oldernumber ==2)}">
															<f:setPropertyActionListener value="#{bed}"
																target="#{livingManageController.selectedBed}" />
														</p:commandLink></td>
												</tr>
											</table>
										</td>
									</tr>
									<tr>
										<td align="center" class="hengbiaogeHeader1">床位号</td>
										<td class="hengbiaogedata"><h:outputText
												value=" #{bed.name}" /></td>
									</tr>
									<tr>
										<td align="center" class="hengbiaogeHeader1">房间号</td>
										<td class="hengbiaogedata"><h:outputText
												value=" #{bed.roomname}" /></td>
									</tr>
									<tr>
										<td align="center" class="hengbiaogeHeader1">房间朝向</td>
										<td class="hengbiaogedata"><h:outputText
												value=" #{bed.way}" /></td>
									</tr>
									<tr>
										<td align="center" class="hengbiaogeHeader1">类型</td>
										<td class="hengbiaogedata"><h:outputText
												value=" #{bed.typename}" /></td>
									</tr>

									<tr>
										<td align="center" class="hengbiaogeHeader1">人数</td>
										<td class="hengbiaogedata"><h:outputText
												value=" #{bed.oldernumber}" /></td>
									</tr>
								</table>
							</ui:repeat>
						</ui:repeat>
					</p:tab>
				</p:tabView>
				<p:commandButton id="hiddenbtn"
					actionListener="#{livingManageController.selectOlderBed}"
					oncomplete="bedDialogHide(xhr,status,args)" style="display:none;"
					update=":addForm:tabView:bedId,:addForm:tabView:bedName,:addForm:tabView:bedType,:addForm:tabView:bedTypeId,:message"></p:commandButton>
			</h:form>
			</div>
		</p:dialog>
		<!--是否发送入住通知的dialog -->
		<p:dialog appendTo="@(body)" modal="true" header="入住通知"
			widgetVar="confirmSendDialog" width="220">
			<h:form id="confirmForm">
				<h:panelGrid>
					<f:facet name="header">
						<h:outputText value="是否发送入住通知？" style="font-weight:bold;" />
					</f:facet>
					<f:facet name="footer">
						<p:commandButton styleClass="submitbtn" value=""
							actionListener="#{livingManageController.sentMessage}"
							oncomplete="confirmSendDialog.hide();"
							update=":message,:olderLivingForm:olderLivingTable"></p:commandButton>
						<p:commandButton styleClass="cancelbtn" value="" type="button"
							update=":olderLivingForm:olderLivingTable"
							onclick="confirmSendDialog.hide();addApplyDialog.hide()"></p:commandButton>
					</f:facet>
				</h:panelGrid>
			</h:form>
		</p:dialog>
		<!--选择床位的的dialog add by mary 2013-12-10-->
		<p:dialog appendTo="@(body)" modal="true" header="选择床位"
			widgetVar="treeNodeDig" width="530" height="420">
			<h:form id="treeNodeForm">
				<p:tree id="treeSingle" value="#{livingManageController.root}"
					var="node" style="width:100%" selectionMode="single"
					rowKey="#{node.name}">
					<p:ajax event="select" process="@this,"
						listener="#{livingManageController.onNodeSelect}"
						oncomplete="hideTree(xhr, status, args)"
						update=":addForm:tabView:bedId,:addForm:tabView:bedName,:addForm:tabView:bedType,:addForm:tabView:bedTypeId,:message" />

					<p:treeNode style="width:100%">
						<h:outputText value="#{node.name}" />
					</p:treeNode>
					<p:treeNode type="bed">
						<h:outputText styleClass="#{node.oldernumber lt 1?'B1':'B2'}"
							value="#{node.name}&nbsp;[床位标准]：#{node.typename}&nbsp;[人数]：#{node.oldernumber}" />
					</p:treeNode>
				</p:tree>
			</h:form>
		</p:dialog>
		<script type="text/javascript">
			function bedDialogHide(xhr, status, args) {
				if (args.validate) {
					bedDialog.hide();
				}
			}
			function hideTree(xhr, status, args) {
				if (args.validate) {
					treeNodeDig.hide();
				}
			}
			function addConfirm(xhr, status, args) {
				if (args.addSuccess) {
					confirmSendDialog.show();
					addLivingDialog.hide();
				} else if (args.success) {
					addLivingDialog.hide();
				}

			}

			function addLivingDialogShow(xhr, status, args) {
				if (args.showEdit) {
					addLivingDialog.show();
				}
			}

			function addFamilyDialogshow(xhr, status, args) {
				if (args.edit) {
					addFamilyDialog.show();
				}
			}
			function addFamilyDialogHide(xhr, status, args) {
				if (args.modifySuccess) {
					addFamilyDialog.hide();
				}
			}

			function hideBtnClick() {
				jQuery("#bedForm\\:hiddenbtn").click();
			}
			/*  取消滚动条
			 */
			jQuery(document).ready(function() {
				cleanBar();
			});
		</script>
	</h:body>
</f:view>
</html>