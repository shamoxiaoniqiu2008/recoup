<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:his="http://centling.his.net/histag" style="width:100%">

<!-- 回车键，往下！引入的js文件 -->
<f:view contentType="text/html" style="width:100%">
	<h:head>
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/default.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/skin.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/layout.css"></link>
		<link href="#{request.contextPath}/css/css.css" rel="stylesheet"
			type="text/css" />
		<link rel="stylesheet" href="#{request.contextPath}/css/style.css">
		</link>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		</meta>
		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/ime.js?ver=#{projectConfig.ver}" />
		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/calendar.js?ver=#{projectConfig.ver}" />
		<h:outputScript library="javax.faces" name="jsf.js" target="head" />
		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/common.js?ver=#{projectConfig.ver}" />
	</h:head>
	<body>
		<p:growl id="msg" widgetVar="message"></p:growl>
		<h:form id="signForm">
			<h:outputText value="活动项目:"></h:outputText>
			<p:inputText id="itemSignInput"
				value="#{activitySignController.itemName}"></p:inputText>
			<his:IME for="signForm:itemSignInput"
				fitcol="#{activitySignController.fitcolItem}" resultcol="1"
				lock="false" rawSQL="true" SQL="#{activitySignController.itemToSql}"
				SQLResult="#{activitySignController.displaycolItem}"
				multiresult="signForm:itemSignInputHidden;0,signForm:itemSignInput;1" />
			<h:inputHidden id="itemSignInputHidden"
				value="#{activitySignController.itemId}"></h:inputHidden>
			<h:outputText value="老人姓名:"></h:outputText>
			<p:inputText id="itemSignInputOld"
				value="#{activitySignController.olderName}"></p:inputText>
			<his:IME for="signForm:itemSignInputOld"
				fitcol="#{activitySignController.fitcolName}" resultcol="1"
				lock="false" rawSQL="true" SQL="#{activitySignController.nameToSql}"
				SQLResult="#{activitySignController.displaycolName}"
				multiresult="signForm:itemSignInputOldHidden;0,signForm:itemSignInputOld;1" />
			<h:inputHidden id="itemSignInputOldHidden"
				value="#{activitySignController.olderId}"></h:inputHidden>
			<h:outputText value="报名时间:"></h:outputText>
			<p:calendar size="12" value="#{activitySignController.startDate}"
				pattern="yyyy-MM-dd" id="startDateCal"></p:calendar>
			<h:outputText value="至"></h:outputText>
			<p:calendar size="12" value="#{activitySignController.endDate}"
				pattern="yyyy-MM-dd" id="endDateCal"></p:calendar>
			<h:outputText value="是否参加:"></h:outputText>
			<h:selectOneMenu value="#{activitySignController.attendIsOrNotFlag}"
				id="isOrNotMenu"
				class="ui-inputfield ui-widget ui-state-default ui-corner-all hasDatepicker ui-state-hover">
				<f:selectItem itemValue="3" itemLabel="全部"></f:selectItem>
				<f:selectItem itemValue="2" itemLabel="否"></f:selectItem>
				<f:selectItem itemValue="1" itemLabel="是"></f:selectItem>
			</h:selectOneMenu>
			<p:commandButton styleClass="searchbtn" value=""
				action="#{activitySignController.getListByCondition}"
				update=":msg,:signForm:signTable"></p:commandButton>
			<p:commandButton styleClass="blankbtn" value=""
				action="#{activitySignController.initParam}" update=":signForm"></p:commandButton>
			<p:dataTable id="signTable" emptyMessage="没有找到记录！"
				value="#{activitySignController.pensionAttendolderList}"
				var="attendList" rowKey="#{attendList.id}" selectionMode="single"
				rows="10" paginatorAlwaysVisible="false"
				selection="#{activitySignController.selectedensionAttendolder}"
				paginator="true" paginatorPosition="bottom"
				paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}">
				<p:ajax event="rowSelect"
					listener="#{activitySignController.setSelectedFlag}"
					update=":signForm" />
				<p:ajax event="rowUnselect"
					listener="#{activitySignController.setUnselectedFlag}"
					update=":signForm" />
				<p:column headerText="老人姓名">
					<h:outputText value="#{attendList.olderName}"></h:outputText>
				</p:column>
				<p:column headerText="活动项目">
					<h:outputText value="#{attendList.itemName}"></h:outputText>
				</p:column>
				<p:column headerText="举办时间">
					<h:outputText value="#{attendList.startDate}">
						<f:convertDateTime pattern="yyyy-MM-dd HH:mm"></f:convertDateTime>
					</h:outputText>
				</p:column>
				<p:column headerText="举办地点">
					<h:outputText value="#{attendList.itemplace}"></h:outputText>
				</p:column>
				<p:column headerText="报名时间">
					<h:outputText value="#{attendList.enlisttime}">
						<f:convertDateTime pattern="yyyy-MM-dd HH:mm"></f:convertDateTime>
					</h:outputText>
				</p:column>
			</p:dataTable>
			<p:watermark value="调用输入法" for="itemSignInput"></p:watermark>
			<p:watermark value="调用输入法" for="itemSignInputOld"></p:watermark>
			<p:watermark value="起始时间" for="startDateCal"></p:watermark>
			<p:watermark value="截止时间" for="endDateCal"></p:watermark>
			<div align="center">
				<p:commandButton styleClass="addbtn" value=""
					onclick="signDialog.show()" update=":signAttendForm"
					action="#{activitySignController.initAddParam}"></p:commandButton>
				<p:commandButton styleClass="modifybtn" value="" id="modifyButton"
					disabled="#{activitySignController.modifyEnableFlag}"
					oncomplete="modifyDialog.show()"
					actionListener="#{activitySignController.initEditAttend}"
					update=":modifyAttendForm"></p:commandButton>
				<p:commandButton styleClass="deletebtn" value="" id="deleteButton"
					onclick="deleteDialog.show()" update=":deleteForm"
					disabled="#{activitySignController.deleteEnableFlag}"
					action="#{activitySignController.setDeleteMsg}"></p:commandButton>
			</div>
		</h:form>
		<p:dialog appendTo="@(body)" header="康娱报名" position="top"
			widgetVar="signDialog" id="signDia" modal="true" closable="true">
			<h:form id="signAttendForm">
				<table id="sginTable" class="hengbiaoge">
					<tr>
						<td class="hengbiaogeHeader1"><label class="redfont"
							for="itemNameText">项目名称:</label></td>
						<td class="hengbiaogedata" colspan="3"><p:inputText
								id="itemNameText" size="28"
								value="#{activitySignController.pensionAttendolder.itemName}"></p:inputText>
							<his:IME for="signAttendForm:itemNameText"
								fitcol="#{activitySignController.fitcolItem}" resultcol="1"
								lock="true" rawSQL="true"
								SQL="#{activitySignController.itemToSql}"
								SQLResult="#{activitySignController.displaycolItem}"
								multiresult="signAttendForm:signAttendTextBox;0,signAttendForm:itemNameText;1,signAttendForm:startDate;3" />
							<h:inputHidden id="signAttendTextBox"
								value="#{activitySignController.pensionAttendolder.activityId}"></h:inputHidden>
						</td>
					</tr>
					<tr>
						<td class="hengbiaogeHeader1"><label class="redfont"
							for="olderNameText">老人姓名:</label></td>
						<td class="hengbiaogedata"><p:inputText id="olderNameText"
								value="#{activitySignController.pensionAttendolder.olderName}"
								size="28"></p:inputText> <his:IME
								for="signAttendForm:olderNameText"
								fitcol="#{activitySignController.fitcolName}" resultcol="1"
								lock="false" rawSQL="true"
								SQL="#{activitySignController.addNameToSql}"
								SQLResult="#{activitySignController.displaycolName}"
								multiresult="signAttendForm:olderNameTextHidden;0,signAttendForm:olderNameText;1" />
						</td>
						<h:inputHidden id="olderNameTextHidden"
							value="#{activitySignController.pensionAttendolder.olderId}"></h:inputHidden>

					</tr>
					<tr>
						<td class="hengbiaogeHeader1"><h:outputText value="举办时间:"></h:outputText></td>
						<td class="hengbiaogedata"><p:inputText id="startDate"
								readonly="true" size="28"
								value="#{activitySignController.pensionAttendolder.startDate}">
								<f:convertDateTime pattern="yyyy-MM-dd HH:mm"></f:convertDateTime>
							</p:inputText></td>

					</tr>
				</table>
				<h:panelGrid columns="2" style="margin:0px auto">
					<p:commandButton styleClass="savebtn" value=""
						onstart="return checkNulls('signAttendForm','redfont',true);"
						action="#{activitySignController.addOlderAttend}"
						update=":msg,:signForm:signTable"
						oncomplete="handleAddRequest(xhr, status, args)"></p:commandButton>
					<p:commandButton styleClass="closebtn" value=""
						onclick="signDialog.hide()"></p:commandButton>
				</h:panelGrid>
				<p:watermark value="调用输入法" for="itemNameText"></p:watermark>
				<p:watermark value="调用输入法" for="olderNameText"></p:watermark>
			</h:form>
		</p:dialog>

		<p:dialog appendTo="@(body)" header="报名修改" position="center"
			widgetVar="modifyDialog" id="modifyDia" modal="true">
			<h:form id="modifyAttendForm" styleClass="noDisable">
				<table id="modifyTable" class="hengbiaoge">
					<tr>
						<td class="hengbiaogeHeader1"><label class="redfont"
							for="itemNameTextmodify">活动项目:</label></td>
						<td class="hengbiaogedata"><p:inputText
								id="itemNameTextmodify" size="28"
								value="#{activitySignController.editensionAttendolder.itemName}">
							</p:inputText> <his:IME for="modifyAttendForm:itemNameTextmodify"
								fitcol="#{activitySignController.fitcolItem}" resultcol="1"
								lock="true" rawSQL="true"
								SQL="#{activitySignController.itemToSql}"
								SQLResult="#{activitySignController.displaycolItem}"
								multiresult="modifyAttendForm:signAttendTextBoxmodify;0,modifyAttendForm:startDate;3,modifyAttendForm:startDate2;3" />
							<h:inputHidden id="signAttendTextBoxmodify"
								value="#{activitySignController.editensionAttendolder.activityId}"></h:inputHidden>
						</td>
					</tr>
					<tr>
						<td class="hengbiaogeHeader1"><h:outputText value="老人姓名:"></h:outputText></td>
						<td class="hengbiaogedata"><p:inputText
								id="olderNameTextmodify" size="28"
								value="#{activitySignController.editensionAttendolder.olderName}"
								disabled="true"></p:inputText> <his:IME
								for="modifyAttendForm:olderNameText"
								fitcol="#{activitySignController.fitcolName}" resultcol="1"
								lock="false" rawSQL="true"
								SQL="#{activitySignController.nameToSql}"
								SQLResult="#{activitySignController.displaycolName}"
								multiresult="modifyAttendForm:olderNameTextHiddenmodify;0,modifyAttendForm:olderNameTextmodify;1" />
						</td>
						<h:inputHidden id="olderNameTextHiddenmodify"
							value="#{activitySignController.selectedensionAttendolder.olderId}"></h:inputHidden>
						<h:inputHidden id="startDate2"
							value="#{activitySignController.editensionAttendolder.startDate}">
							<f:convertDateTime pattern="yyyy-MM-dd HH:mm"></f:convertDateTime>
						</h:inputHidden>
					</tr>
					<tr>
						<td class="hengbiaogeHeader1"><h:outputText value="举办时间:"></h:outputText></td>
						<td class="hengbiaogedata"><p:inputText id="startDate"
								disabled="true" size="28"
								value="#{activitySignController.editensionAttendolder.startDate}">
								<f:convertDateTime pattern="yyyy-MM-dd HH:mm"></f:convertDateTime>
							</p:inputText></td>

					</tr>
				</table>
				<div align="center">
					<p:commandButton styleClass="savebtn" value=""
						onstart="return checkNulls('modifyAttendForm','redfont',true);"
						action="#{activitySignController.modifyOlderAttend}"
						update=":msg,:signForm:signTable"
						oncomplete="handleSaveRequest(xhr, status, args)"></p:commandButton>
					<p:commandButton styleClass="closebtn" value=""
						onclick="modifyDialog.hide()"></p:commandButton>
				</div>
				<p:watermark value="调用输入法" for="itemNameTextmodify"></p:watermark>
			</h:form>
		</p:dialog>

		<p:dialog header="删除确认" position="center" widgetVar="deleteDialog"
			id="deleteDia" modal="true">
			<h:form id="deleteForm">
				<h:outputText value="#{activitySignController.strDeleteMsg}">
				</h:outputText>
				<h:panelGrid columns="2" style="margin:0px auto">
					<p:commandButton styleClass="submitbtn" value=""
						action="#{activitySignController.deleteOlderAttend}"
						update=":msg,:signForm:signTable,:signForm:modifyButton,:signForm:deleteButton"
						oncomplete="deleteDialog.hide()"></p:commandButton>
					<p:commandButton styleClass="closebtn" value=""
						onclick="deleteDialog.hide()"></p:commandButton>
				</h:panelGrid>
			</h:form>
		</p:dialog>
		<script type="text/javascript">
			function handleAddRequest(xhr, status, args) {
				if (args.canAddFlag) {
					signDialog.hide();
				}
			}

			function handleSaveRequest(xhr, status, args) {
				if (args.canSaveFlag) {
					modifyDialog.hide();
				}
			}
		</script>
	</body>
</f:view>
</html>