<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:his="http://centling.his.net/histag" style="width:100%">

<!-- 回车键，往下！引入的js文件 -->
<f:view contentType="text/html" style="width:100%">
	<h:head>
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/default.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/skin.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/layout.css"></link>
		<link href="#{request.contextPath}/css/css.css" rel="stylesheet"
			type="text/css" />
		<link rel="stylesheet" href="#{request.contextPath}/css/style.css">
		</link>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		</meta>
		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/ime.js?ver=#{projectConfig.ver}" />
		<script type="text/javascript"
			src="#{request.contextPath}/resources/js/calendar.js?ver=#{projectConfig.ver}" />
	</h:head>
	<p:growl id="msg"></p:growl>
	<h:form id="scrappyConfirmForm">
		<table style="width: 100%">
			<tr>
				<td><h:panelGrid columns="1">
						<h:panelGroup id="olderSearchGroupRight1">
							<h:inputHidden id="olderNameInputRightHidden"
								value="#{scrappyOrderConfirmController.olderId}"></h:inputHidden>
							<h:outputText value="老人姓名:"></h:outputText>
							<p:inputText id="olderNameInputRight"
								value="#{scrappyOrderConfirmController.olderName}"></p:inputText>
							<his:IME for="scrappyConfirmForm:olderNameInputRight"
								fitcol="olderId,inputCode" resultcol="1" lock="false"
								rawSQL="true" SQL="#{scrappyOrderConfirmController.nameToSql}"
								SQLResult="编号:0,姓名:1,输入码:2,性别:3"
								multiresult="scrappyConfirmForm:olderNameInputRightHidden;0,scrappyConfirmForm:olderNameInputRight;1" />
							<h:outputText value="就餐时间:"></h:outputText>
							<p:calendar id="dinnerStartCal" size="12"
								value="#{scrappyOrderConfirmController.startDiningDate}"
								pattern="yyyy-MM-dd"></p:calendar>
							<h:outputText value="至"></h:outputText>
							<p:calendar id="dinnerEndCal" size="12"
								value="#{scrappyOrderConfirmController.endDiningDate}"
								pattern="yyyy-MM-dd"></p:calendar>
							<h:outputText value="是否确认:"></h:outputText>
							<h:selectOneMenu
								value="#{scrappyOrderConfirmController.confirmFlag}"
								id="isOkOneMenu"
								class="ui-inputfield ui-widget ui-state-default ui-corner-all hasDatepicker ui-state-hover">
								<f:selectItem itemValue="3" itemLabel="全部"></f:selectItem>
								<f:selectItem itemValue="1" itemLabel="是"></f:selectItem>
								<f:selectItem itemValue="2" itemLabel="否"></f:selectItem>
							</h:selectOneMenu>
							<h:outputText value="是否交款:"></h:outputText>
							<h:selectOneMenu value="#{scrappyOrderConfirmController.payFlag}"
								id="isPayOneMenu"
								class="ui-inputfield ui-widget ui-state-default ui-corner-all hasDatepicker ui-state-hover">
								<f:selectItem itemValue="3" itemLabel="全部"></f:selectItem>
								<f:selectItem itemValue="1" itemLabel="是"></f:selectItem>
								<f:selectItem itemValue="2" itemLabel="否"></f:selectItem>
							</h:selectOneMenu>
							<p:commandButton id="olderSearchButtonRight"
								styleClass="searchbtn" value=""
								action="#{scrappyOrderConfirmController.scrappyOrderedByCondition}"
								update=":msg,:scrappyConfirmForm:menuTableRight"></p:commandButton>
							<p:commandButton styleClass="blankbtn" value=""
								action="#{scrappyOrderConfirmController.initPara}"
								update=":scrappyConfirmForm"></p:commandButton>
						</h:panelGroup>

					</h:panelGrid> <p:dataTable id="menuTableRight" emptyMessage="没有找到记录！" rows="10"
						value="#{scrappyOrderConfirmController.pensionOrderList}"
						var="pensionOrderList" rowKey="#{pensionOrderList.id}"
						rowIndexVar="row" paginatorAlwaysVisible="false"
						selection="#{scrappyOrderConfirmController.selectedRows}"
						paginator="true" paginatorPosition="bottom"
						paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}">
						<p:ajax event="rowSelectCheckbox"
							listener="#{scrappyOrderConfirmController.selectRecord}"
							update=":scrappyConfirmForm" />
						<p:ajax event="rowUnselectCheckbox"
							listener="#{scrappyOrderConfirmController.unSelectRecord}"
							update=":scrappyConfirmForm" />
						<p:column selectionMode="multiple" width="30">
						</p:column>
						<p:column headerText="老人">
							<h:outputText value="#{pensionOrderList.olderName}"></h:outputText>
						</p:column>
						<p:column headerText="菜名">
							<h:outputText value="#{pensionOrderList.menuName}"></h:outputText>
						</p:column>
						<p:column headerText="数量">
							<h:outputText value="#{pensionOrderList.orderNumber}"></h:outputText>
						</p:column>
						<p:column headerText="就餐时间">
							<h:outputText value="#{pensionOrderList.eattime}">
								<f:convertDateTime pattern="yyyy-MM-dd HH:mm"></f:convertDateTime>
							</h:outputText>
						</p:column>
						<p:column headerText="是否派送">
							<h:outputText value="#{pensionOrderList.sendFlagName}"></h:outputText>
						</p:column>
						<p:column headerText="是否确认">
							<h:outputText value="#{pensionOrderList.isConfirmName}"></h:outputText>
						</p:column>
						<p:column headerText="是否交款">
							<h:outputText value="#{pensionOrderList.isPayName}"></h:outputText>
						</p:column>
						<p:column headerText="备注">
							<h:outputText value="#{pensionOrderList.notes}"></h:outputText>
						</p:column>
					</p:dataTable> <p:watermark value="调用输入法" for="olderNameInputRight"></p:watermark>
					<p:watermark value="输入开始时间" for="dinnerStartCal"></p:watermark> <p:watermark
						value="输入截止时间" for="dinnerEndCal"></p:watermark></td>
			</tr>
		</table>
		<div align="center">
			<h:panelGroup id="selectAllGroup">
				<h:outputLabel value="选择全部:"></h:outputLabel>
				<h:selectBooleanCheckbox id="selectAllBooleanCheckBox"
					valueChangeListener="#{scrappyOrderConfirmController.setSelectedAllFlag}"
					value="#{scrappyOrderConfirmController.selectedAllFlag}">
					<p:ajax event="change" update=":scrappyConfirmForm,:msg"></p:ajax>
				</h:selectBooleanCheckbox>
			</h:panelGroup>
			<h:panelGroup id="selectTodayGroup">
				<h:outputLabel value="选择当天:"></h:outputLabel>
				<h:selectBooleanCheckbox id="selectTodayBooleanCheckBox"
					valueChangeListener="#{scrappyOrderConfirmController.setSelectedTodayFlag}"
					value="#{scrappyOrderConfirmController.selectedTodayFlag}">
					<p:ajax event="change" update=":scrappyConfirmForm,:msg"></p:ajax>
				</h:selectBooleanCheckbox>
			</h:panelGroup>
			<p:commandButton id="confirmButton" value="点餐确认"
				styleClass="commonbtn"
				action="#{scrappyOrderConfirmController.checkDialogShow}"
				oncomplete="checkOkDialogShow(xhr, status, args)" update=":msg">
			</p:commandButton>
		</div>
	</h:form>
	<p:dialog appendTo="@(body)" header="点餐确认" position="center"
		widgetVar="confirmDialog" modal="true" id="confirmDialog">
		<h:form>
			<h:outputText value="是否确认点餐？确认后不可以撤销！"></h:outputText>
			<h:panelGrid columns="2" style="margin:0px auto">
				<p:commandButton styleClass="submitbtn" value=""
					action="#{scrappyOrderConfirmController.saveTempPayInfo}"
					update=":msg,:scrappyConfirmForm:menuTableRight,:scrappyConfirmForm"
					oncomplete="confirmDialog.hide()"></p:commandButton>
				<p:commandButton styleClass="closebtn" value=""
					onclick="confirmDialog.hide()"></p:commandButton>
			</h:panelGrid>
		</h:form>
	</p:dialog>

	<script type="text/javascript">
		function showConfirmDialog() {
			confirmDialog.show();
		}

		function checkOkDialogShow(xhr, status, args) {
			if (args.isOKFlag) {
				confirmDialog.show();
			}
		}
	</script>
</f:view>
</html>