<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:his="http://centling.his.net/histag">

<!-- 回车键，往下！引入的js文件 -->
<f:view contentType="text/html">
	<h:head>
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/default.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/skin.css" />
		<link type="text/css" rel="stylesheet"
			href="#{request.contextPath}/css/layout.css"></link>
		<link href="#{request.contextPath}/css/css.css" rel="stylesheet"
			type="text/css" />
		<link rel="stylesheet" href="#{request.contextPath}/css/style.css" ></link>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	    <script type="text/javascript" src="#{request.contextPath}/resources/js/ime.js?ver=#{projectConfig.ver}" />
	<script type="text/javascript" src="#{request.contextPath}/resources/js/calendar.js?ver=#{projectConfig.ver}" />
	<h:outputScript library="javax.faces" name="jsf.js" target="head" />
	</h:head>
	<h:body>
	<p:growl id="messages"></p:growl>
	<p:fieldset legend="消耗量查询" >
	<h:form id="consumptionHeadForm">
		<h:panelGrid columns="15">
			<h:outputText value="&nbsp;&nbsp;起始时间:" style="width:80" />
			<p:calendar id="startDate" pattern="yyyy-MM-dd" size="15"
				value="#{sumRepairGoodsController.consumptionStartDate}" />
			<h:outputText value="截止时间:" style="width:80" />
			<p:calendar id="endDate" pattern="yyyy-MM-dd" size="15"
				value="#{sumRepairGoodsController.consumptionEndDate}" />
			<h:outputText value="材料名:" style="text-align:right" />
			<h:panelGroup>
				<p:inputText id="itemName" />
				<his:IME for="consumptionHeadForm:itemName" rawSQL="true"
					SQL="#{sumRepairGoodsController.goodsSql}"
					fitcol="itemId"
					SQLResult="编号:0:hide,名称:1,数量:2" 
					resultcol="1"
					lock="true"
					multiresult="consumptionHeadForm:itemId;0" />
				<h:inputHidden value="#{sumRepairGoodsController.consumptionItemId}" id="itemId" />
			</h:panelGroup>
			<p:commandButton id="searchButton"
				action="#{sumRepairGoodsController.selectConsumptionRecords}"
				styleClass="searchbtn" value=""
				update=":consumptionDataTableForm:consumptionTable,:messages" />
			<p:commandButton oncomplete="clearConsumptionSelectForm()" styleClass="blankbtn" value="" 
						action="#{sumRepairGoodsController.clearConsumptionSelectForm}" update=":consumptionHeadForm,:messages"/>
		</h:panelGrid>
	</h:form>
	</p:fieldset>
	<h:form id="consumptionDataTableForm">
		<h:panelGrid id="consumptionRecord"  style="width:100%">
			<p:dataTable cellspacing="8" rows="10" style="width:100%"
				id="consumptionTable" rowIndexVar="row"
				value="#{sumRepairGoodsController.consumptionRecords}"
				var="record" rowKey="#{record.id}"  emptyMessage="没有相应记录"
				paginator="true" paginatorPosition="bottom"
				paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
				>
				<p:column headerText="材料名称">
					<h:outputText value="#{record.itemName}" />
				</p:column>
				<p:column headerText="材料编号">
					<h:outputText value="#{record.itemId}" />
				</p:column>
				<p:column headerText="消耗量">
					<h:outputText value="#{record.itemQty}" />
				</p:column>
			</p:dataTable>
		</h:panelGrid>
	</h:form>
	<p:fieldset legend="剩余量查询" >
	<h:form id="remainHeadForm">
		<h:panelGrid columns="15">
			<h:outputText value="&nbsp;&nbsp;截止日期:" style="width:80" />
			<p:calendar id="endDate" pattern="yyyy-MM-dd" size="15"
				value="#{sumRepairGoodsController.remainEndDate}" />
			<h:outputText value="材料名:" style="text-align:right" />
			<h:panelGroup>
				<p:inputText id="itemName"/>
				<his:IME for="remainHeadForm:itemName" rawSQL="true"
					SQL="#{repairHandleController.goodsSql}"
					fitcol="itemId"
					SQLResult="编号:0:hide,名称:1,数量:2" 
					resultcol="1"
					lock="true"
					multiresult="remainHeadForm:itemId;0" />
				<h:inputHidden value="#{sumRepairGoodsController.remainItemId}" id="itemId" />
			</h:panelGroup>
			<p:commandButton id="searchButton"
				action="#{sumRepairGoodsController.selectRemainRecords}"
				styleClass="searchbtn" value=""
				update=":remainDataTableForm:remainTable,:messages" />
			<p:commandButton oncomplete="clearRemainSelectForm()" styleClass="blankbtn" value="" 
						action="#{sumRepairGoodsController.clearRemainSelectForm}" update=":remainHeadForm,:messages"/>
		</h:panelGrid>
	</h:form>
	</p:fieldset>
	<h:form id="remainDataTableForm">
		<h:panelGrid id="remainRecord"  style="width:100%">
			<p:dataTable cellspacing="8" rows="10" style="width:100%"
				id="remainTable" rowIndexVar="row"
				value="#{sumRepairGoodsController.remainRecords}"
				var="record" rowKey="#{record.id}"  emptyMessage="没有相应记录"
				paginator="true" paginatorPosition="bottom"
				paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
				>
				<p:column headerText="材料名称">
					<h:outputText value="#{record.itemName}" />
				</p:column>
				<p:column headerText="材料编号">
					<h:outputText value="#{record.itemId}" />
				</p:column>
				<p:column headerText="剩余量">
					<h:outputText value="#{record.itemQty}" />
				</p:column>
			</p:dataTable>
		</h:panelGrid>
	</h:form>
	<script type="text/javascript">
		//清空 consumptionHeadForm
		function clearConsumptionSelectForm(){
			document.getElementById("consumptionHeadForm:startDate").value="";
			document.getElementById("consumptionHeadForm:endDate").value="";
			document.getElementById("consumptionHeadForm:itemName").value="";
			
			return true;
		}
		//清空 consumptionHeadForm
		function clearRemainSelectForm(){
			document.getElementById("remainHeadForm:endDate").value="";
			document.getElementById("remainHeadForm:itemName").value="";
			
			return true;
		}

	</script>
	</h:body>
</f:view>
</html>